# Generated by Django 4.2 on 2025-11-24 16:05

from django.db import migrations
from django.utils.translation import gettext_lazy as _


def populate_sections(apps, schema_editor):
    """Populate section registry with all application sections."""
    SectionRegistry = apps.get_model('shared', 'SectionRegistry')
    
    sections_data = [
        # Module 00 - Dashboard/UI
        {
            'section_code': '000000',
            'nickname': 'dashboard',
            'module_code': '00',
            'menu_number': '00',
            'submenu_number': None,
            'name': 'داشبورد',
            'name_en': 'Dashboard',
            'description': 'صفحه اصلی و داشبورد سیستم',
            'module': 'ui',
            'app_label': 'ui',
            'list_url_name': 'ui:dashboard',
            'detail_url_name': None,
            'sort_order': 0,
        },
        
        # Module 01 - Shared
        {
            'section_code': '010000',
            'nickname': 'companies',
            'module_code': '01',
            'menu_number': '00',
            'submenu_number': None,
            'name': 'شرکت‌ها',
            'name_en': 'Companies',
            'description': 'مدیریت شرکت‌ها',
            'module': 'shared',
            'app_label': 'shared',
            'list_url_name': 'shared:companies',
            'detail_url_name': 'shared:company_edit',
            'sort_order': 0,
        },
        {
            'section_code': '010100',
            'nickname': 'company_units',
            'module_code': '01',
            'menu_number': '01',
            'submenu_number': None,
            'name': 'واحدهای سازمانی',
            'name_en': 'Company Units',
            'description': 'مدیریت واحدهای سازمانی شرکت',
            'module': 'shared',
            'app_label': 'shared',
            'list_url_name': 'shared:company_units',
            'detail_url_name': 'shared:company_unit_edit',
            'sort_order': 1,
        },
        {
            'section_code': '010200',
            'nickname': 'smtp_servers',
            'module_code': '01',
            'menu_number': '02',
            'submenu_number': None,
            'name': 'سرورهای SMTP',
            'name_en': 'SMTP Servers',
            'description': 'تنظیمات سرورهای ایمیل',
            'module': 'shared',
            'app_label': 'shared',
            'list_url_name': 'shared:smtp_servers',
            'detail_url_name': 'shared:smtp_server_edit',
            'sort_order': 2,
        },
        {
            'section_code': '010301',
            'nickname': 'users',
            'module_code': '01',
            'menu_number': '03',
            'submenu_number': '01',
            'name': 'کاربران',
            'name_en': 'Users',
            'description': 'مدیریت کاربران سیستم',
            'module': 'shared',
            'app_label': 'shared',
            'list_url_name': 'shared:users',
            'detail_url_name': 'shared:user_edit',
            'sort_order': 1,
        },
        {
            'section_code': '010302',
            'nickname': 'groups',
            'module_code': '01',
            'menu_number': '03',
            'submenu_number': '02',
            'name': 'گروه‌ها',
            'name_en': 'Groups',
            'description': 'مدیریت گروه‌های کاربری',
            'module': 'shared',
            'app_label': 'shared',
            'list_url_name': 'shared:groups',
            'detail_url_name': 'shared:group_edit',
            'sort_order': 2,
        },
        {
            'section_code': '010303',
            'nickname': 'access_levels',
            'module_code': '01',
            'menu_number': '03',
            'submenu_number': '03',
            'name': 'سطوح دسترسی',
            'name_en': 'Access Levels',
            'description': 'مدیریت سطوح دسترسی',
            'module': 'shared',
            'app_label': 'shared',
            'list_url_name': 'shared:access_levels',
            'detail_url_name': 'shared:access_level_edit',
            'sort_order': 3,
        },
        
        # Module 02 - Inventory - Master Data
        {
            'section_code': '020101',
            'nickname': 'item_types',
            'module_code': '02',
            'menu_number': '01',
            'submenu_number': '01',
            'name': 'انواع کالا',
            'name_en': 'Item Types',
            'description': 'مدیریت انواع کالا',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:item_types',
            'detail_url_name': 'inventory:itemtype_edit',
            'sort_order': 1,
        },
        {
            'section_code': '020102',
            'nickname': 'item_categories',
            'module_code': '02',
            'menu_number': '01',
            'submenu_number': '02',
            'name': 'دسته‌بندی کالا',
            'name_en': 'Item Categories',
            'description': 'مدیریت دسته‌بندی‌های کالا',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:item_categories',
            'detail_url_name': 'inventory:itemcategory_edit',
            'sort_order': 2,
        },
        {
            'section_code': '020103',
            'nickname': 'item_subcategories',
            'module_code': '02',
            'menu_number': '01',
            'submenu_number': '03',
            'name': 'زیردسته‌بندی کالا',
            'name_en': 'Item Subcategories',
            'description': 'مدیریت زیردسته‌بندی‌های کالا',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:item_subcategories',
            'detail_url_name': 'inventory:itemsubcategory_edit',
            'sort_order': 3,
        },
        {
            'section_code': '020104',
            'nickname': 'warehouses',
            'module_code': '02',
            'menu_number': '01',
            'submenu_number': '04',
            'name': 'انبارها',
            'name_en': 'Warehouses',
            'description': 'مدیریت انبارها',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:warehouses',
            'detail_url_name': 'inventory:warehouse_edit',
            'sort_order': 4,
        },
        
        # Module 02 - Inventory - Items
        {
            'section_code': '020201',
            'nickname': 'items_create',
            'module_code': '02',
            'menu_number': '02',
            'submenu_number': '01',
            'name': 'ایجاد کالا',
            'name_en': 'Create Item',
            'description': 'ایجاد کالای جدید',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': None,
            'detail_url_name': 'inventory:item_create',
            'sort_order': 1,
        },
        {
            'section_code': '020202',
            'nickname': 'items',
            'module_code': '02',
            'menu_number': '02',
            'submenu_number': '02',
            'name': 'کالاها',
            'name_en': 'Items',
            'description': 'لیست و مدیریت کالاها',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:items',
            'detail_url_name': 'inventory:item_edit',
            'sort_order': 2,
        },
        {
            'section_code': '020203',
            'nickname': 'item_serials',
            'module_code': '02',
            'menu_number': '02',
            'submenu_number': '03',
            'name': 'سریال‌های کالا',
            'name_en': 'Item Serials',
            'description': 'مدیریت سریال‌های کالا',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:item_serials',
            'detail_url_name': None,
            'sort_order': 3,
        },
        {
            'section_code': '020204',
            'nickname': 'inventory_balance',
            'module_code': '02',
            'menu_number': '02',
            'submenu_number': '04',
            'name': 'موجودی انبار',
            'name_en': 'Inventory Balance',
            'description': 'مشاهده موجودی انبار',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:inventory_balance',
            'detail_url_name': None,
            'sort_order': 4,
        },
        
        # Module 02 - Inventory - Suppliers
        {
            'section_code': '020301',
            'nickname': 'supplier_categories',
            'module_code': '02',
            'menu_number': '03',
            'submenu_number': '01',
            'name': 'دسته‌بندی تأمین‌کنندگان',
            'name_en': 'Supplier Categories',
            'description': 'مدیریت دسته‌بندی‌های تأمین‌کنندگان',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:supplier_categories',
            'detail_url_name': 'inventory:suppliercategory_edit',
            'sort_order': 1,
        },
        {
            'section_code': '020302',
            'nickname': 'suppliers',
            'module_code': '02',
            'menu_number': '03',
            'submenu_number': '02',
            'name': 'تأمین‌کنندگان',
            'name_en': 'Suppliers',
            'description': 'مدیریت تأمین‌کنندگان',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:suppliers',
            'detail_url_name': 'inventory:supplier_edit',
            'sort_order': 2,
        },
        
        # Module 02 - Inventory - Requests
        {
            'section_code': '020400',
            'nickname': 'purchase_requests',
            'module_code': '02',
            'menu_number': '04',
            'submenu_number': None,
            'name': 'درخواست‌های خرید',
            'name_en': 'Purchase Requests',
            'description': 'مدیریت درخواست‌های خرید',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:purchase_requests',
            'detail_url_name': 'inventory:purchase_request_edit',
            'sort_order': 5,
        },
        {
            'section_code': '020500',
            'nickname': 'warehouse_requests',
            'module_code': '02',
            'menu_number': '05',
            'submenu_number': None,
            'name': 'درخواست‌های انبار',
            'name_en': 'Warehouse Requests',
            'description': 'مدیریت درخواست‌های انبار',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:warehouse_requests',
            'detail_url_name': 'inventory:warehouse_request_edit',
            'sort_order': 6,
        },
        
        # Module 02 - Inventory - Receipts
        {
            'section_code': '020601',
            'nickname': 'receipt_temporary',
            'module_code': '02',
            'menu_number': '06',
            'submenu_number': '01',
            'name': 'رسید موقت',
            'name_en': 'Temporary Receipts',
            'description': 'مدیریت رسیدهای موقت',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:receipt_temporary',
            'detail_url_name': 'inventory:receipt_temporary_edit',
            'sort_order': 1,
        },
        {
            'section_code': '020602',
            'nickname': 'receipt_permanent',
            'module_code': '02',
            'menu_number': '06',
            'submenu_number': '02',
            'name': 'رسید دائم',
            'name_en': 'Permanent Receipts',
            'description': 'مدیریت رسیدهای دائم',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:receipt_permanent',
            'detail_url_name': 'inventory:receipt_permanent_edit',
            'sort_order': 2,
        },
        {
            'section_code': '020603',
            'nickname': 'receipt_consignment',
            'module_code': '02',
            'menu_number': '06',
            'submenu_number': '03',
            'name': 'رسید امانی',
            'name_en': 'Consignment Receipts',
            'description': 'مدیریت رسیدهای امانی',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:receipt_consignment',
            'detail_url_name': 'inventory:receipt_consignment_edit',
            'sort_order': 3,
        },
        
        # Module 02 - Inventory - Issues
        {
            'section_code': '020701',
            'nickname': 'issue_permanent',
            'module_code': '02',
            'menu_number': '07',
            'submenu_number': '01',
            'name': 'حواله دائم',
            'name_en': 'Permanent Issues',
            'description': 'مدیریت حواله‌های دائم',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:issue_permanent',
            'detail_url_name': 'inventory:issue_permanent_edit',
            'sort_order': 1,
        },
        {
            'section_code': '020702',
            'nickname': 'issue_consumption',
            'module_code': '02',
            'menu_number': '07',
            'submenu_number': '02',
            'name': 'حواله مصرف',
            'name_en': 'Consumption Issues',
            'description': 'مدیریت حواله‌های مصرف',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:issue_consumption',
            'detail_url_name': 'inventory:issue_consumption_edit',
            'sort_order': 2,
        },
        {
            'section_code': '020703',
            'nickname': 'issue_consignment',
            'module_code': '02',
            'menu_number': '07',
            'submenu_number': '03',
            'name': 'حواله امانی',
            'name_en': 'Consignment Issues',
            'description': 'مدیریت حواله‌های امانی',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:issue_consignment',
            'detail_url_name': 'inventory:issue_consignment_edit',
            'sort_order': 3,
        },
        
        # Module 02 - Inventory - Stocktaking
        {
            'section_code': '020801',
            'nickname': 'stocktaking_deficit',
            'module_code': '02',
            'menu_number': '08',
            'submenu_number': '01',
            'name': 'کمبود موجودی',
            'name_en': 'Stocktaking Deficit',
            'description': 'ثبت کمبودهای موجودی',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:stocktaking_deficit',
            'detail_url_name': 'inventory:stocktaking_deficit_edit',
            'sort_order': 1,
        },
        {
            'section_code': '020802',
            'nickname': 'stocktaking_surplus',
            'module_code': '02',
            'menu_number': '08',
            'submenu_number': '02',
            'name': 'مازاد موجودی',
            'name_en': 'Stocktaking Surplus',
            'description': 'ثبت مازادهای موجودی',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:stocktaking_surplus',
            'detail_url_name': 'inventory:stocktaking_surplus_edit',
            'sort_order': 2,
        },
        {
            'section_code': '020803',
            'nickname': 'stocktaking_records',
            'module_code': '02',
            'menu_number': '08',
            'submenu_number': '03',
            'name': 'سوابق شمارش',
            'name_en': 'Stocktaking Records',
            'description': 'مدیریت سوابق شمارش موجودی',
            'module': 'inventory',
            'app_label': 'inventory',
            'list_url_name': 'inventory:stocktaking_records',
            'detail_url_name': 'inventory:stocktaking_record_edit',
            'sort_order': 3,
        },
        
        # Module 03 - Production
        {
            'section_code': '030000',
            'nickname': 'personnel',
            'module_code': '03',
            'menu_number': '00',
            'submenu_number': None,
            'name': 'پرسنل',
            'name_en': 'Personnel',
            'description': 'مدیریت پرسنل تولید',
            'module': 'production',
            'app_label': 'production',
            'list_url_name': 'production:personnel',
            'detail_url_name': 'production:person_edit',
            'sort_order': 0,
        },
        {
            'section_code': '030100',
            'nickname': 'machines',
            'module_code': '03',
            'menu_number': '01',
            'submenu_number': None,
            'name': 'ماشین‌آلات',
            'name_en': 'Machines',
            'description': 'مدیریت ماشین‌آلات تولید',
            'module': 'production',
            'app_label': 'production',
            'list_url_name': 'production:machines',
            'detail_url_name': 'production:machine_edit',
            'sort_order': 1,
        },
        {
            'section_code': '030200',
            'nickname': 'work_lines',
            'module_code': '03',
            'menu_number': '02',
            'submenu_number': None,
            'name': 'خطوط کاری',
            'name_en': 'Work Lines',
            'description': 'مدیریت خطوط کاری',
            'module': 'production',
            'app_label': 'production',
            'list_url_name': 'production:work_lines',
            'detail_url_name': 'production:work_line_edit',
            'sort_order': 2,
        },
        {
            'section_code': '030300',
            'nickname': 'bom',
            'module_code': '03',
            'menu_number': '03',
            'submenu_number': None,
            'name': 'BOM',
            'name_en': 'Bill of Materials',
            'description': 'مدیریت فهرست مواد اولیه',
            'module': 'production',
            'app_label': 'production',
            'list_url_name': 'production:bom_list',
            'detail_url_name': 'production:bom_edit',
            'sort_order': 3,
        },
        {
            'section_code': '030400',
            'nickname': 'processes',
            'module_code': '03',
            'menu_number': '04',
            'submenu_number': None,
            'name': 'فرایندها',
            'name_en': 'Processes',
            'description': 'مدیریت فرایندهای تولید',
            'module': 'production',
            'app_label': 'production',
            'list_url_name': 'production:processes',
            'detail_url_name': 'production:process_edit',
            'sort_order': 4,
        },
        {
            'section_code': '036000',
            'nickname': 'product_orders',
            'module_code': '03',
            'menu_number': '60',
            'submenu_number': None,
            'name': 'سفارشات تولید',
            'name_en': 'Product Orders',
            'description': 'مدیریت سفارشات تولید',
            'module': 'production',
            'app_label': 'production',
            'list_url_name': 'production:product_orders',
            'detail_url_name': 'production:product_order_edit',
            'sort_order': 6,
        },
        {
            'section_code': '036100',
            'nickname': 'transfer_requests',
            'module_code': '03',
            'menu_number': '61',
            'submenu_number': None,
            'name': 'درخواست‌های انتقال',
            'name_en': 'Transfer Requests',
            'description': 'درخواست‌های انتقال به پای کار',
            'module': 'production',
            'app_label': 'production',
            'list_url_name': 'production:transfer_requests',
            'detail_url_name': 'production:transfer_request_edit',
            'sort_order': 7,
        },
        {
            'section_code': '036800',
            'nickname': 'performance_records',
            'module_code': '03',
            'menu_number': '68',
            'submenu_number': None,
            'name': 'سند عملکرد',
            'name_en': 'Performance Records',
            'description': 'مدیریت سند عملکرد',
            'module': 'production',
            'app_label': 'production',
            'list_url_name': 'production:performance_records',
            'detail_url_name': 'production:performance_record_edit',
            'sort_order': 8,
        },
        
        # Module 04 - QC
        {
            'section_code': '041000',
            'nickname': 'inspections',
            'module_code': '04',
            'menu_number': '10',
            'submenu_number': None,
            'name': 'بازرسی',
            'name_en': 'Inspections',
            'description': 'بازرسی رسیدهای موقت',
            'module': 'qc',
            'app_label': 'qc',
            'list_url_name': 'qc:temporary_receipts',
            'detail_url_name': None,
            'sort_order': 0,
        },
    ]
    
    for section_data in sections_data:
        SectionRegistry.objects.get_or_create(
            section_code=section_data['section_code'],
            defaults=section_data
        )


def populate_actions(apps, schema_editor):
    """Populate action registry with actions for each section."""
    SectionRegistry = apps.get_model('shared', 'SectionRegistry')
    ActionRegistry = apps.get_model('shared', 'ActionRegistry')
    
    # Helper to get section by code
    def get_section(code):
        try:
            return SectionRegistry.objects.get(section_code=code)
        except SectionRegistry.DoesNotExist:
            return None
    
    actions_data = [
        # Users (010301)
        ('010301', 'show', 'مشاهده', 'View', 'shared:users', {'gp': {'type': 'string', 'required': False, 'description': 'Group name filter'}}, None, 0, 0, 1),
        ('010301', 'showown', 'مشاهده خود', 'View Own', None, {}, None, 0, 0, 2),
        ('010301', 'add', 'ایجاد', 'Create', 'shared:user_create', {}, 'shared.users:create', 0, 0, 3),
        ('010301', 'edit', 'ویرایش', 'Edit', 'shared:user_edit', {'id': {'type': 'integer', 'required': True, 'description': 'User ID'}}, 'shared.users:edit_own', 0, 0, 4),
        ('010301', 'delete', 'حذف', 'Delete', 'shared:user_delete', {'id': {'type': 'integer', 'required': True, 'description': 'User ID'}}, 'shared.users:delete_own', 1, 1, 5),
        
        # Purchase Requests (020400)
        ('020400', 'show', 'مشاهده', 'View', 'inventory:purchase_requests', {}, 'inventory.requests.purchase:view_all', 0, 0, 1),
        ('020400', 'add', 'ایجاد', 'Create', 'inventory:purchase_request_create', {}, 'inventory.requests.purchase:create', 0, 0, 2),
        ('020400', 'edit', 'ویرایش', 'Edit', 'inventory:purchase_request_edit', {'id': {'type': 'integer', 'required': True}}, 'inventory.requests.purchase:edit_own', 0, 0, 3),
        ('020400', 'approve', 'تایید', 'Approve', 'inventory:purchase_request_approve', {'id': {'type': 'integer', 'required': True}, 'code': {'type': 'string', 'required': False}}, 'inventory.requests.purchase:approve', 1, 0, 4),
        ('020400', 'create_receipt_from', 'ایجاد رسید', 'Create Receipt', None, {'id': {'type': 'integer', 'required': True}, 'type': {'type': 'string', 'required': True, 'enum': ['temporary', 'permanent', 'consignment']}}, 'inventory.receipts.*:create_receipt_from_purchase_request', 0, 0, 5),
        
        # Warehouse Requests (020500)
        ('020500', 'show', 'مشاهده', 'View', 'inventory:warehouse_requests', {}, 'inventory.requests.warehouse:view_all', 0, 0, 1),
        ('020500', 'add', 'ایجاد', 'Create', 'inventory:warehouse_request_create', {}, 'inventory.requests.warehouse:create', 0, 0, 2),
        ('020500', 'edit', 'ویرایش', 'Edit', 'inventory:warehouse_request_edit', {'id': {'type': 'integer', 'required': True}}, 'inventory.requests.warehouse:edit_own', 0, 0, 3),
        ('020500', 'approve', 'تایید', 'Approve', 'inventory:warehouse_request_approve', {'id': {'type': 'integer', 'required': True}, 'code': {'type': 'string', 'required': False}}, 'inventory.requests.warehouse:approve', 1, 0, 4),
        ('020500', 'create_issue_from', 'ایجاد حواله', 'Create Issue', None, {'id': {'type': 'integer', 'required': True}, 'type': {'type': 'string', 'required': True, 'enum': ['permanent', 'consumption', 'consignment']}}, 'inventory.issues.*:create_issue_from_warehouse_request', 0, 0, 5),
        
        # Receipts - Temporary (020601)
        ('020601', 'show', 'مشاهده', 'View', 'inventory:receipt_temporary', {}, 'inventory.receipts.temporary:view_all', 0, 0, 1),
        ('020601', 'add', 'ایجاد', 'Create', 'inventory:receipt_temporary_create', {}, 'inventory.receipts.temporary:create', 0, 0, 2),
        ('020601', 'edit', 'ویرایش', 'Edit', 'inventory:receipt_temporary_edit', {'id': {'type': 'integer', 'required': True}}, 'inventory.receipts.temporary:edit_own', 0, 0, 3),
        ('020601', 'delete', 'حذف', 'Delete', 'inventory:receipt_temporary_delete', {'id': {'type': 'integer', 'required': True}}, 'inventory.receipts.temporary:delete_own', 1, 1, 4),
        ('020601', 'lock', 'قفل', 'Lock', 'inventory:receipt_temporary_lock', {'id': {'type': 'integer', 'required': True}}, 'inventory.receipts.temporary:lock_own', 1, 0, 5),
        ('020601', 'send_to_qc', 'ارسال به QC', 'Send to QC', 'inventory:receipt_temporary_send_to_qc', {'id': {'type': 'integer', 'required': True}}, 'inventory.receipts.temporary:send_to_qc', 1, 0, 6),
        
        # Receipts - Permanent (020602)
        ('020602', 'show', 'مشاهده', 'View', 'inventory:receipt_permanent', {}, 'inventory.receipts.permanent:view_all', 0, 0, 1),
        ('020602', 'add', 'ایجاد', 'Create', 'inventory:receipt_permanent_create', {}, 'inventory.receipts.permanent:create', 0, 0, 2),
        ('020602', 'edit', 'ویرایش', 'Edit', 'inventory:receipt_permanent_edit', {'id': {'type': 'integer', 'required': True}}, 'inventory.receipts.permanent:edit_own', 0, 0, 3),
        ('020602', 'delete', 'حذف', 'Delete', 'inventory:receipt_permanent_delete', {'id': {'type': 'integer', 'required': True}}, 'inventory.receipts.permanent:delete_own', 1, 1, 4),
        ('020602', 'lock', 'قفل', 'Lock', 'inventory:receipt_permanent_lock', {'id': {'type': 'integer', 'required': True}}, 'inventory.receipts.permanent:lock_own', 1, 0, 5),
        
        # Receipts - Consignment (020603)
        ('020603', 'show', 'مشاهده', 'View', 'inventory:receipt_consignment', {}, 'inventory.receipts.consignment:view_all', 0, 0, 1),
        ('020603', 'add', 'ایجاد', 'Create', 'inventory:receipt_consignment_create', {}, 'inventory.receipts.consignment:create', 0, 0, 2),
        ('020603', 'edit', 'ویرایش', 'Edit', 'inventory:receipt_consignment_edit', {'id': {'type': 'integer', 'required': True}}, 'inventory.receipts.consignment:edit_own', 0, 0, 3),
        ('020603', 'delete', 'حذف', 'Delete', 'inventory:receipt_consignment_delete', {'id': {'type': 'integer', 'required': True}}, 'inventory.receipts.consignment:delete_own', 1, 1, 4),
        ('020603', 'lock', 'قفل', 'Lock', 'inventory:receipt_consignment_lock', {'id': {'type': 'integer', 'required': True}}, 'inventory.receipts.consignment:lock_own', 1, 0, 5),
        
        # Issues - Permanent (020701)
        ('020701', 'show', 'مشاهده', 'View', 'inventory:issue_permanent', {}, 'inventory.issues.permanent:view_all', 0, 0, 1),
        ('020701', 'add', 'ایجاد', 'Create', 'inventory:issue_permanent_create', {}, 'inventory.issues.permanent:create', 0, 0, 2),
        ('020701', 'edit', 'ویرایش', 'Edit', 'inventory:issue_permanent_edit', {'id': {'type': 'integer', 'required': True}}, 'inventory.issues.permanent:edit_own', 0, 0, 3),
        ('020701', 'delete', 'حذف', 'Delete', 'inventory:issue_permanent_delete', {'id': {'type': 'integer', 'required': True}}, 'inventory.issues.permanent:delete_own', 1, 1, 4),
        ('020701', 'lock', 'قفل', 'Lock', 'inventory:issue_permanent_lock', {'id': {'type': 'integer', 'required': True}}, 'inventory.issues.permanent:lock_own', 1, 0, 5),
        
        # Issues - Consumption (020702)
        ('020702', 'show', 'مشاهده', 'View', 'inventory:issue_consumption', {}, 'inventory.issues.consumption:view_all', 0, 0, 1),
        ('020702', 'add', 'ایجاد', 'Create', 'inventory:issue_consumption_create', {}, 'inventory.issues.consumption:create', 0, 0, 2),
        ('020702', 'edit', 'ویرایش', 'Edit', 'inventory:issue_consumption_edit', {'id': {'type': 'integer', 'required': True}}, 'inventory.issues.consumption:edit_own', 0, 0, 3),
        ('020702', 'delete', 'حذف', 'Delete', 'inventory:issue_consumption_delete', {'id': {'type': 'integer', 'required': True}}, 'inventory.issues.consumption:delete_own', 1, 1, 4),
        ('020702', 'lock', 'قفل', 'Lock', 'inventory:issue_consumption_lock', {'id': {'type': 'integer', 'required': True}}, 'inventory.issues.consumption:lock_own', 1, 0, 5),
        
        # Issues - Consignment (020703)
        ('020703', 'show', 'مشاهده', 'View', 'inventory:issue_consignment', {}, 'inventory.issues.consignment:view_all', 0, 0, 1),
        ('020703', 'add', 'ایجاد', 'Create', 'inventory:issue_consignment_create', {}, 'inventory.issues.consignment:create', 0, 0, 2),
        ('020703', 'edit', 'ویرایش', 'Edit', 'inventory:issue_consignment_edit', {'id': {'type': 'integer', 'required': True}}, 'inventory.issues.consignment:edit_own', 0, 0, 3),
        ('020703', 'delete', 'حذف', 'Delete', 'inventory:issue_consignment_delete', {'id': {'type': 'integer', 'required': True}}, 'inventory.issues.consignment:delete_own', 1, 1, 4),
        ('020703', 'lock', 'قفل', 'Lock', 'inventory:issue_consignment_lock', {'id': {'type': 'integer', 'required': True}}, 'inventory.issues.consignment:lock_own', 1, 0, 5),
        
        # Inspections (041000)
        ('041000', 'show', 'مشاهده', 'View', 'qc:temporary_receipts', {}, None, 0, 0, 1),
        ('041000', 'showown', 'مشاهده خود', 'View Own', None, {}, None, 0, 0, 2),
        ('041000', 'approve', 'تایید', 'Approve', 'qc:temporary_receipt_approve', {'id': {'type': 'integer', 'required': True}, 'code': {'type': 'string', 'required': False}}, None, 1, 0, 3),
        ('041000', 'reject', 'رد', 'Reject', 'qc:temporary_receipt_reject', {'id': {'type': 'integer', 'required': True}, 'code': {'type': 'string', 'required': False}}, None, 1, 0, 4),
    ]
    
    for section_code, action_name, action_label, action_label_en, url_name, parameter_schema, permission_required, requires_confirmation, is_destructive, sort_order in actions_data:
        section = get_section(section_code)
        if not section:
            continue
        ActionRegistry.objects.get_or_create(
            section=section,
            action_name=action_name,
            defaults={
                'action_label': action_label,
                'action_label_en': action_label_en,
                'url_name': url_name,
                'parameter_schema': parameter_schema,
                'permission_required': permission_required,
                'requires_confirmation': requires_confirmation,
                'is_destructive': is_destructive,
                'sort_order': sort_order,
                'is_enabled': 1,
            }
        )


def reverse_populate(apps, schema_editor):
    """Reverse migration - delete all data."""
    SectionRegistry = apps.get_model('shared', 'SectionRegistry')
    ActionRegistry = apps.get_model('shared', 'ActionRegistry')
    ActionRegistry.objects.all().delete()
    SectionRegistry.objects.all().delete()


class Migration(migrations.Migration):

    dependencies = [
        ('shared', '0011_add_section_and_action_registry'),
    ]

    operations = [
        migrations.RunPython(populate_sections, reverse_populate),
        migrations.RunPython(populate_actions, migrations.RunPython.noop),
    ]
