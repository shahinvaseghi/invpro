{% extends "shared/generic/generic_list.html" %}
{% load i18n %}

{% block filter_fields %}
<div class="form-group">
  <label for="search">{% trans "Search" %}</label>
  <input type="text" name="search" id="search" 
         placeholder="{{ search_placeholder|default:'Search by code or name' }}" 
         value="{{ request.GET.search }}"
         class="form-control">
</div>
<div class="form-group">
  <label for="status">{% trans "Status" %}</label>
  <select name="status" id="status" class="form-control">
    <option value="">-- {% trans "All" %} --</option>
    <option value="active" {% if status_filter_value == "active" %}selected{% endif %}>{% trans "Active" %}</option>
    <option value="inactive" {% if status_filter_value == "inactive" %}selected{% endif %}>{% trans "Inactive" %}</option>
  </select>
</div>
{% endblock %}

{% block table_headers %}
<th>{% trans "Username" %}</th>
<th>{% trans "Name" %}</th>
<th>{% trans "Email" %}</th>
<th>{% trans "Default Company" %}</th>
<th>{% trans "Groups" %}</th>
<th>{% trans "Company Access" %}</th>
<th>{% trans "Status" %}</th>
{% if show_actions %}
  <th>{% trans "Actions" %}</th>
{% endif %}
{% endblock %}

{% block table_rows %}
{% for user in object_list %}
<tr>
  <td>{{ user.username }}</td>
  <td>{{ user.get_full_name|default:user.username }}</td>
  <td>{{ user.email|default:"-" }}</td>
  <td>{% if user.default_company %}{{ user.default_company.display_name }}{% else %}-{% endif %}</td>
  <td>
    {% with group_list=user.groups.all %}
      {% if group_list %}
        {{ group_list|join:", " }}
      {% else %}
        -
      {% endif %}
    {% endwith %}
  </td>
  <td>
    {% with accesses=user.company_accesses.all %}
      {% if accesses %}
        <ul class="inline-list" style="margin: 0; padding: 0; list-style: none;">
          {% for access in accesses %}
            <li style="margin-bottom: 4px;">
              {{ access.company.display_name }} â€“
              {{ access.access_level.name }}
              {% if access.is_primary %}
                <span class="badge badge-info">{% trans "Primary" %}</span>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        -
      {% endif %}
    {% endwith %}
  </td>
  <td>
    {% if user.is_active %}
      <span class="badge badge-active">{% trans "Active" %}</span>
    {% else %}
      <span class="badge badge-inactive">{% trans "Inactive" %}</span>
    {% endif %}
  </td>
  {% if show_actions %}
  <td>
    {% include 'shared/partials/row_actions.html' with object=user feature_code=feature_code detail_url_name=detail_url_name edit_url_name=edit_url_name delete_url_name=delete_url_name %}
  </td>
  {% endif %}
</tr>
{% endfor %}
{% endblock %}

