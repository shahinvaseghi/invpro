{% extends "base.html" %}
{% load i18n %}
{% load generic_tags %}
{% load access_tags %}
{% load view_tags %}

{% block title %}{{ page_title|default:"List" }} - {{ block.super }}{% endblock %}

{% block content %}
<div class="inventory-module">
  <div class="module-header">
    <nav class="breadcrumb">
      <a href="{% url 'ui:dashboard' %}">{% trans "Dashboard" %}</a>
      {% for crumb in breadcrumbs %}
        <span class="separator">/</span>
        {% if crumb.url %}
          <a href="{{ crumb.url }}">{{ crumb.label }}</a>
        {% else %}
          <span>{{ crumb.label }}</span>
        {% endif %}
      {% endfor %}
      {% block breadcrumb_extra %}{% endblock %}
    </nav>
    
    <h1 class="page-title">{{ page_title|default:"List" }}</h1>
    
    {% block page_actions %}
    <div class="page-actions">
      {% if create_url %}
        <a href="{{ create_url }}" class="btn btn-primary">
          + {{ create_button_text|default:"Create New" }}
        </a>
      {% endif %}
      {% if print_enabled %}
        <button class="btn btn-secondary" onclick="window.print()">{% trans "Print" %}</button>
      {% endif %}
      {% block extra_actions %}{% endblock %}
    </div>
    {% endblock %}
  </div>

  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }}" style="margin-bottom: 1rem; padding: 1rem; border-radius: 4px; {% if message.tags == 'error' %}background-color: #fee; border: 1px solid #fcc; color: #c00;{% elif message.tags == 'success' %}background-color: #efe; border: 1px solid #cfc; color: #0c0;{% elif message.tags == 'warning' %}background-color: #ffe; border: 1px solid #ffc; color: #cc0;{% else %}background-color: #eef; border: 1px solid #ccf; color: #00c;{% endif %}">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}

  {% if show_filters %}
    {% include 'shared/partials/filter_panel.html' %}
  {% endif %}

  {% if stats %}
    {% include 'shared/partials/stats_cards.html' %}
  {% endif %}

  {% block before_table %}{% endblock %}

  {% if object_list %}
  <div class="data-table-container">
    <table class="data-table">
      <thead>
        <tr>
          {% block table_headers %}
          {% for header in table_headers %}
            <th>{{ header.label }}</th>
          {% endfor %}
          {% if show_actions %}
            <th>{% trans "Actions" %}</th>
          {% endif %}
          {% endblock %}
        </tr>
      </thead>
      <tbody>
        {% block table_rows %}
        {% for object in object_list %}
        <tr>
          {% for header in table_headers %}
            <td>
              {% if header.field %}
                {% with value=object|getattr:header.field %}
                  {% if header.type == 'code' %}
                    <code>{{ value }}</code>
                  {% elif header.type == 'badge' %}
                    {% if value %}
                      <span class="badge badge-active">{{ header.true_label|default:"Active" }}</span>
                    {% else %}
                      <span class="badge badge-inactive">{{ header.false_label|default:"Inactive" }}</span>
                    {% endif %}
                  {% elif header.type == 'link' and header.url_field %}
                    <a href="{% url header.url_name object|getattr:header.url_field %}">{{ value }}</a>
                  {% else %}
                    {{ value|default:"-" }}
                  {% endif %}
                {% endwith %}
              {% else %}
                {{ header.custom_content|default:"-" }}
              {% endif %}
            </td>
          {% endfor %}
          {% if show_actions %}
            <td>
              {% block action_buttons %}
                {% include 'shared/partials/row_actions.html' with object=object feature_code=feature_code detail_url_name=detail_url_name edit_url_name=edit_url_name delete_url_name=delete_url_name %}
              {% endblock %}
            </td>
          {% endif %}
        </tr>
        {% endfor %}
        {% endblock %}
      </tbody>
    </table>
  </div>

  {% if is_paginated %}
    {% include 'shared/partials/pagination.html' %}
  {% endif %}

  {% else %}
    {% include 'shared/partials/empty_state.html' with title=empty_state_title message=empty_state_message icon=empty_state_icon create_url=create_url create_button_text=create_button_text %}
  {% endif %}

  {% block after_table %}{% endblock %}
</div>

<style>
.alert {
  padding: 1rem 1.5rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;
  border: 1px solid;
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.alert-success {
  background-color: #d1fae5;
  border-color: #10b981;
  color: #065f46;
}

.alert-error,
.alert-danger {
  background-color: #fee2e2;
  border-color: #ef4444;
  color: #991b1b;
}

.alert-info {
  background-color: #dbeafe;
  border-color: #3b82f6;
  color: #1e40af;
}

.alert-warning {
  background-color: #fef3c7;
  border-color: #f59e0b;
  color: #92400e;
}
</style>
{% endblock %}

