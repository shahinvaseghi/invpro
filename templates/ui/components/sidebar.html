{% load i18n access_tags %}
<nav class="sidebar-nav">
  <div class="sidebar-section" data-section="shared">
    <button type="button" class="section-header" data-target="shared">
      <span class="section-title">{% trans "Shared" %}</span>
      <span class="section-icon">▼</span>
    </button>
    <div class="section-content" id="shared">
      <a href="{% url 'ui:dashboard' %}" class="nav-link">{% trans "Dashboard" %}</a>
      {% if user_feature_permissions|feature_allowed:'shared.companies' %}
        <a href="{% url 'shared:companies' %}" class="nav-link">{% trans "Companies" %}</a>
      {% endif %}
      {% if user_feature_permissions|feature_allowed:'shared.company_units' %}
        <a href="{% url 'shared:company_units' %}" class="nav-link">{% trans "Company Units" %}</a>
      {% endif %}
      {% if user_feature_permissions|feature_allowed:'shared.users' or user_feature_permissions|feature_allowed:'shared.groups' or user_feature_permissions|feature_allowed:'shared.access_levels' %}
        <div class="nav-group">
          <button type="button" class="nav-group-header" data-submenu="shared-users">
            <span>{% trans "Users" %}</span>
            <span class="nav-group-icon">▼</span>
          </button>
          <div class="nav-group-content" id="shared-users">
            {% if user_feature_permissions|feature_allowed:'shared.users' %}
              <a href="{% url 'shared:users' %}" class="nav-link-sub">{% trans "Users" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'shared.groups' %}
              <a href="{% url 'shared:groups' %}" class="nav-link-sub">{% trans "Groups" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'shared.access_levels' %}
              <a href="{% url 'shared:access_levels' %}" class="nav-link-sub">{% trans "Access Levels" %}</a>
            {% endif %}
          </div>
        </div>
      {% endif %}
    </div>
  </div>

  <div class="sidebar-section" data-section="inventory">
    <button type="button" class="section-header" data-target="inventory">
      <span class="section-title">{% trans "Inventory" %}</span>
      <span class="section-icon">▼</span>
    </button>
    <div class="section-content" id="inventory">
      {% if user_feature_permissions|feature_allowed:'inventory.master.item_types' or user_feature_permissions|feature_allowed:'inventory.master.item_categories' or user_feature_permissions|feature_allowed:'inventory.master.item_subcategories' or user_feature_permissions|feature_allowed:'inventory.master.warehouses' %}
        <div class="nav-group">
          <button type="button" class="nav-group-header" data-submenu="inventory-master">
            <span>{% trans "Master Data" %}</span>
            <span class="nav-group-icon">▼</span>
          </button>
          <div class="nav-group-content" id="inventory-master">
            {% if user_feature_permissions|feature_allowed:'inventory.master.item_types' %}
              <a href="{% url 'inventory:item_types' %}" class="nav-link-sub">{% trans "Item Types" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.master.item_categories' %}
              <a href="{% url 'inventory:item_categories' %}" class="nav-link-sub">{% trans "Item Categories" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.master.item_subcategories' %}
              <a href="{% url 'inventory:item_subcategories' %}" class="nav-link-sub">{% trans "Item Subcategories" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.master.warehouses' %}
              <a href="{% url 'inventory:warehouses' %}" class="nav-link-sub">{% trans "Warehouses" %}</a>
            {% endif %}
          </div>
        </div>
      {% endif %}

      {% if user_feature_permissions|feature_allowed:'inventory.master.items' or user_feature_permissions|feature_allowed:'inventory.balance' %}
        <div class="nav-group">
          <button type="button" class="nav-group-header" data-submenu="inventory-items">
            <span>{% trans "Items" %}</span>
            <span class="nav-group-icon">▼</span>
          </button>
          <div class="nav-group-content" id="inventory-items">
            {% if user_feature_permissions|feature_allowed:'inventory.master.items:create' %}
              <a href="{% url 'inventory:item_create' %}" class="nav-link-sub">{% trans "Create Item" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.master.items' %}
              <a href="{% url 'inventory:items' %}" class="nav-link-sub">{% trans "Edit Items" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.master.item_serials' %}
              <a href="{% url 'inventory:item_serials' %}" class="nav-link-sub">{% trans "Item Serials" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.balance' %}
              <a href="{% url 'inventory:inventory_balance' %}" class="nav-link-sub">{% trans "Inventory Balance" %}</a>
            {% endif %}
          </div>
        </div>
      {% endif %}

      {% if user_feature_permissions|feature_allowed:'inventory.suppliers.categories' or user_feature_permissions|feature_allowed:'inventory.suppliers.list' %}
        <div class="nav-group">
          <button type="button" class="nav-group-header" data-submenu="inventory-suppliers">
            <span>{% trans "Suppliers" %}</span>
            <span class="nav-group-icon">▼</span>
          </button>
          <div class="nav-group-content" id="inventory-suppliers">
            {% if user_feature_permissions|feature_allowed:'inventory.suppliers.categories' %}
              <a href="{% url 'inventory:supplier_categories' %}" class="nav-link-sub">{% trans "Supplier Categories" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.suppliers.list' %}
              <a href="{% url 'inventory:suppliers' %}" class="nav-link-sub">{% trans "Supplier List" %}</a>
            {% endif %}
          </div>
        </div>
      {% endif %}

      {% if user_feature_permissions|feature_allowed:'inventory.requests.purchase' %}
        <a href="{% url 'inventory:purchase_requests' %}" class="nav-link">{% trans "Purchase Requests" %}</a>
      {% endif %}
      {% if user_feature_permissions|feature_allowed:'inventory.requests.warehouse' %}
        <a href="{% url 'inventory:warehouse_requests' %}" class="nav-link">{% trans "Warehouse Requests" %}</a>
      {% endif %}

      {% if user_feature_permissions|feature_allowed:'inventory.receipts.temporary' or user_feature_permissions|feature_allowed:'inventory.receipts.permanent' or user_feature_permissions|feature_allowed:'inventory.receipts.consignment' %}
        <div class="nav-group">
          <button type="button" class="nav-group-header" data-submenu="inventory-receipts">
            <span>{% trans "Receipts" %}</span>
            <span class="nav-group-icon">▼</span>
          </button>
          <div class="nav-group-content" id="inventory-receipts">
            {% if user_feature_permissions|feature_allowed:'inventory.receipts.temporary' %}
              <a href="{% url 'inventory:receipt_temporary' %}" class="nav-link-sub">{% trans "Temporary Receipts" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.receipts.permanent' %}
              <a href="{% url 'inventory:receipt_permanent' %}" class="nav-link-sub">{% trans "Permanent Receipts" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.receipts.consignment' %}
              <a href="{% url 'inventory:receipt_consignment' %}" class="nav-link-sub">{% trans "Consignment Receipts" %}</a>
            {% endif %}
          </div>
        </div>
      {% endif %}

      {% if user_feature_permissions|feature_allowed:'inventory.issues.permanent' or user_feature_permissions|feature_allowed:'inventory.issues.consumption' or user_feature_permissions|feature_allowed:'inventory.issues.consignment' %}
        <div class="nav-group">
          <button type="button" class="nav-group-header" data-submenu="inventory-issues">
            <span>{% trans "Issues" %}</span>
            <span class="nav-group-icon">▼</span>
          </button>
          <div class="nav-group-content" id="inventory-issues">
            {% if user_feature_permissions|feature_allowed:'inventory.issues.permanent' %}
              <a href="{% url 'inventory:issue_permanent' %}" class="nav-link-sub">{% trans "Permanent Issues" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.issues.consumption' %}
              <a href="{% url 'inventory:issue_consumption' %}" class="nav-link-sub">{% trans "Consumption Issues" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.issues.consignment' %}
              <a href="{% url 'inventory:issue_consignment' %}" class="nav-link-sub">{% trans "Consignment Issues" %}</a>
            {% endif %}
          </div>
        </div>
      {% endif %}

      {% if user_feature_permissions|feature_allowed:'inventory.stocktaking.deficit' or user_feature_permissions|feature_allowed:'inventory.stocktaking.surplus' or user_feature_permissions|feature_allowed:'inventory.stocktaking.records' %}
        <div class="nav-group">
          <button type="button" class="nav-group-header" data-submenu="inventory-stocktaking">
            <span>{% trans "Stocktaking" %}</span>
            <span class="nav-group-icon">▼</span>
          </button>
          <div class="nav-group-content" id="inventory-stocktaking">
            {% if user_feature_permissions|feature_allowed:'inventory.stocktaking.deficit' %}
              <a href="{% url 'inventory:stocktaking_deficit' %}" class="nav-link-sub">{% trans "Deficit Records" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.stocktaking.surplus' %}
              <a href="{% url 'inventory:stocktaking_surplus' %}" class="nav-link-sub">{% trans "Surplus Records" %}</a>
            {% endif %}
            {% if user_feature_permissions|feature_allowed:'inventory.stocktaking.records' %}
              <a href="{% url 'inventory:stocktaking_records' %}" class="nav-link-sub">{% trans "Stocktaking Records" %}</a>
            {% endif %}
          </div>
        </div>
      {% endif %}
    </div>
  </div>

  {% if user_feature_permissions|feature_allowed:'production.personnel' or user_feature_permissions|feature_allowed:'production.machines' or user_feature_permissions|feature_allowed:'production.work_lines' or user_feature_permissions|feature_allowed:'production.bom' or user_feature_permissions|feature_allowed:'production.processes' or user_feature_permissions|feature_allowed:'production.product_orders' or request.user.is_superuser %}
    <div class="sidebar-section" data-section="production">
      <button type="button" class="section-header" data-target="production">
        <span class="section-title">{% trans "Production" %}</span>
        <span class="section-icon">▼</span>
      </button>
      <div class="section-content" id="production">
        {% if user_feature_permissions|feature_allowed:'production.personnel' %}
          <a href="{% url 'production:personnel' %}" class="nav-link">{% trans "Personnel" %}</a>
        {% endif %}
        {% if user_feature_permissions|feature_allowed:'production.machines' %}
          <a href="{% url 'production:machines' %}" class="nav-link">{% trans "Machines" %}</a>
        {% endif %}
        {% if user_feature_permissions|feature_allowed:'production.work_lines' %}
          <a href="{% url 'production:work_lines' %}" class="nav-link">{% trans "Work Lines" %}</a>
        {% endif %}
        {% if user_feature_permissions|feature_allowed:'production.bom' or request.user.is_superuser %}
          <a href="{% url 'production:bom_list' %}" class="nav-link">{% trans "BOM" %}</a>
        {% endif %}
        {% if user_feature_permissions|feature_allowed:'production.processes' or request.user.is_superuser %}
          <a href="{% url 'production:processes' %}" class="nav-link">{% trans "Processes" %}</a>
        {% endif %}
        {% if user_feature_permissions|feature_allowed:'production.product_orders' or request.user.is_superuser %}
          <a href="{% url 'production:product_orders' %}" class="nav-link">{% trans "Product Orders" %}</a>
        {% endif %}
        {% if user_feature_permissions|feature_allowed:'production.transfer_requests' or request.user.is_superuser %}
          <a href="{% url 'production:transfer_requests' %}" class="nav-link">{% trans "Transfer to Line Requests" %}</a>
        {% endif %}
        {% if request.user.is_superuser %}
          <a href="{% url 'production:performance_records' %}" class="nav-link">{% trans "Performance Records" %}</a>
        {% endif %}
      </div>
    </div>
  {% endif %}

  {% if request.user.is_superuser %}
    <div class="sidebar-section" data-section="qc">
      <button type="button" class="section-header" data-target="qc">
        <span class="section-title">{% trans "Quality Control" %}</span>
        <span class="section-icon">▼</span>
      </button>
      <div class="section-content" id="qc">
        <a href="{% url 'qc:temporary_receipts' %}" class="nav-link">{% trans "Temporary Receipts" %}</a>
      </div>
    </div>
  {% endif %}
</nav>

