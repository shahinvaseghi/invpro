# Generated by Django 4.2 on 2025-11-24 19:46

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import django.utils.timezone


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('auth', '0012_alter_user_first_name_max_length'),
        ('shared', '0012_populate_section_and_action_registry'),
    ]

    operations = [
        migrations.CreateModel(
            name='Ticket',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('is_locked', models.PositiveSmallIntegerField(default=0)),
                ('locked_at', models.DateTimeField(blank=True, null=True)),
                ('unlocked_at', models.DateTimeField(blank=True, null=True)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('ticket_code', models.CharField(help_text='Auto-generated ticket identifier (format: TKT-YYYYMMDD-XXXXXX)', max_length=30, unique=True, verbose_name='Ticket Code')),
                ('template_code', models.CharField(help_text='Cached template code', max_length=30, verbose_name='Template Code')),
                ('title', models.CharField(max_length=255, verbose_name='Title')),
                ('description', models.TextField(blank=True, verbose_name='Description')),
                ('category_code', models.CharField(blank=True, help_text='Cached category code', max_length=10, verbose_name='Category Code')),
                ('priority_code', models.CharField(blank=True, help_text='Cached priority code', max_length=10, verbose_name='Priority Code')),
                ('status', models.CharField(choices=[('open', 'Open'), ('in_progress', 'In Progress'), ('assigned', 'Assigned'), ('pending', 'Pending'), ('resolved', 'Resolved'), ('closed', 'Closed'), ('cancelled', 'Cancelled')], default='open', max_length=20, verbose_name='Status')),
                ('reported_by_username', models.CharField(help_text='Cached reporter username', max_length=150, verbose_name='Reported By Username')),
                ('assigned_to_username', models.CharField(blank=True, help_text='Cached assignee username', max_length=150, verbose_name='Assigned To Username')),
                ('assigned_at', models.DateTimeField(blank=True, null=True, verbose_name='Assigned At')),
                ('opened_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Opened At')),
                ('first_response_at', models.DateTimeField(blank=True, null=True, verbose_name='First Response At')),
                ('resolved_at', models.DateTimeField(blank=True, null=True, verbose_name='Resolved At')),
                ('closed_at', models.DateTimeField(blank=True, null=True, verbose_name='Closed At')),
                ('resolution_notes', models.TextField(blank=True, verbose_name='Resolution Notes')),
                ('related_entity_type', models.CharField(blank=True, help_text="Type of related entity (e.g., 'inventory.item', 'production.order')", max_length=50, verbose_name='Related Entity Type')),
                ('related_entity_id', models.BigIntegerField(blank=True, null=True, verbose_name='Related Entity ID')),
                ('related_entity_code', models.CharField(blank=True, max_length=100, verbose_name='Related Entity Code')),
                ('attachments', models.JSONField(blank=True, default=list, help_text='Array of file attachments with metadata', verbose_name='Attachments')),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_tickets', to=settings.AUTH_USER_MODEL, verbose_name='Assigned To')),
            ],
            options={
                'verbose_name': 'Ticket',
                'verbose_name_plural': 'Tickets',
                'ordering': ('-created_at',),
            },
        ),
        migrations.CreateModel(
            name='TicketCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('sort_order', models.PositiveSmallIntegerField(default=0)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('public_code', models.CharField(max_length=10, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')], verbose_name='Category Code')),
                ('name', models.CharField(max_length=120, verbose_name='Name')),
                ('name_en', models.CharField(blank=True, max_length=120, verbose_name='Name (English)')),
                ('description', models.TextField(blank=True, verbose_name='Description')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('disabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL)),
                ('edited_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL)),
                ('enabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL)),
                ('parent_category', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='subcategories', to='ticketing.ticketcategory', verbose_name='Parent Category')),
            ],
            options={
                'verbose_name': 'Ticket Category',
                'verbose_name_plural': 'Ticket Categories',
                'ordering': ('company', 'sort_order', 'public_code'),
            },
        ),
        migrations.CreateModel(
            name='TicketPriority',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('sort_order', models.PositiveSmallIntegerField(default=0)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('public_code', models.CharField(max_length=10, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')], verbose_name='Priority Code')),
                ('name', models.CharField(max_length=120, verbose_name='Name')),
                ('name_en', models.CharField(blank=True, max_length=120, verbose_name='Name (English)')),
                ('priority_level', models.PositiveSmallIntegerField(default=3, help_text='Numeric level (1=highest, 5=lowest) for sorting', verbose_name='Priority Level')),
                ('color', models.CharField(blank=True, help_text="Hex color code for UI display (e.g., '#ff0000')", max_length=7, verbose_name='Color')),
                ('sla_hours', models.IntegerField(blank=True, help_text='Service Level Agreement hours for response time', null=True, verbose_name='SLA Hours')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('disabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL)),
                ('edited_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL)),
                ('enabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Ticket Priority',
                'verbose_name_plural': 'Ticket Priorities',
                'ordering': ('company', 'priority_level', 'sort_order'),
            },
        ),
        migrations.CreateModel(
            name='TicketTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('sort_order', models.PositiveSmallIntegerField(default=0)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('template_code', models.CharField(help_text='Auto-generated template identifier (format: TMP-YYYYMMDD-XXXXXX)', max_length=30, unique=True, verbose_name='Template Code')),
                ('name', models.CharField(max_length=255, verbose_name='Name')),
                ('description', models.TextField(blank=True, verbose_name='Description')),
                ('category_code', models.CharField(blank=True, help_text='Cached category code', max_length=10, verbose_name='Category Code')),
                ('default_priority_code', models.CharField(blank=True, help_text='Cached default priority code', max_length=10, verbose_name='Default Priority Code')),
                ('category', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='templates', to='ticketing.ticketcategory', verbose_name='Category')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('default_priority', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='templates', to='ticketing.ticketpriority', verbose_name='Default Priority')),
                ('disabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL)),
                ('edited_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL)),
                ('enabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Ticket Template',
                'verbose_name_plural': 'Ticket Templates',
                'ordering': ('company', 'sort_order', 'template_code'),
            },
        ),
        migrations.CreateModel(
            name='TicketTemplateField',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('template_code', models.CharField(help_text='Cached template code', max_length=30, verbose_name='Template Code')),
                ('field_name', models.CharField(help_text='Field label/name for display', max_length=255, verbose_name='Field Name')),
                ('field_type', models.CharField(choices=[('short_text', 'Short Text'), ('long_text', 'Long Text'), ('radio', 'Radio Button'), ('dropdown', 'Dropdown'), ('file_upload', 'File Upload'), ('reference', 'Reference'), ('checkbox', 'Checkbox'), ('date', 'Date'), ('time', 'Time'), ('datetime', 'DateTime'), ('number', 'Number'), ('email', 'Email'), ('url', 'URL'), ('phone', 'Phone'), ('multi_select', 'Multi Select'), ('tags', 'Tags'), ('rich_text', 'Rich Text'), ('color', 'Color'), ('rating', 'Rating'), ('slider', 'Slider'), ('currency', 'Currency'), ('signature', 'Signature'), ('location', 'Location'), ('section', 'Section'), ('calculation', 'Calculation')], max_length=30, verbose_name='Field Type')),
                ('field_key', models.CharField(help_text="Unique identifier for the field within template (e.g., 'item_code', 'description')", max_length=100, verbose_name='Field Key')),
                ('is_required', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=0, verbose_name='Is Required')),
                ('default_value', models.TextField(blank=True, verbose_name='Default Value')),
                ('field_order', models.PositiveSmallIntegerField(default=0, help_text='Display order (row position) in the form', verbose_name='Field Order')),
                ('help_text', models.TextField(blank=True, verbose_name='Help Text')),
                ('validation_rules', models.JSONField(blank=True, default=dict, help_text='Validation rules (min/max length, regex patterns, etc.)', verbose_name='Validation Rules')),
                ('field_config', models.JSONField(blank=True, default=dict, help_text='Field-specific configuration (e.g., for reference fields: entity types, for file upload: allowed types, max size)', verbose_name='Field Config')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('disabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL)),
                ('edited_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL)),
                ('enabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL)),
                ('template', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='fields', to='ticketing.tickettemplate', verbose_name='Template')),
            ],
            options={
                'verbose_name': 'Template Field',
                'verbose_name_plural': 'Template Fields',
                'ordering': ('template', 'field_order', 'id'),
            },
        ),
        migrations.CreateModel(
            name='TicketTemplatePermission',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('template_code', models.CharField(help_text='Cached template code', max_length=30, verbose_name='Template Code')),
                ('can_create', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=0, verbose_name='Can Create')),
                ('can_respond', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=0, verbose_name='Can Respond')),
                ('can_close', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=0, verbose_name='Can Close')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('disabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL)),
                ('edited_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL)),
                ('enabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL)),
                ('group', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='ticket_template_permissions', to='auth.group', verbose_name='Group')),
                ('template', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='permissions', to='ticketing.tickettemplate', verbose_name='Template')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='ticket_template_permissions', to=settings.AUTH_USER_MODEL, verbose_name='User')),
            ],
            options={
                'verbose_name': 'Template Permission',
                'verbose_name_plural': 'Template Permissions',
            },
        ),
        migrations.CreateModel(
            name='TicketTemplateFieldOption',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('option_value', models.CharField(help_text='Option value (stored value)', max_length=255, verbose_name='Option Value')),
                ('option_label', models.CharField(help_text='Option label (displayed text)', max_length=255, verbose_name='Option Label')),
                ('option_order', models.PositiveSmallIntegerField(default=0, help_text='Display order in dropdown/radio list', verbose_name='Option Order')),
                ('is_default', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=0, help_text='Whether this option is the default selection', verbose_name='Is Default')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('disabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL)),
                ('edited_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL)),
                ('enabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL)),
                ('template', models.ForeignKey(help_text='Cached template reference', on_delete=django.db.models.deletion.CASCADE, related_name='field_options', to='ticketing.tickettemplate', verbose_name='Template')),
                ('template_field', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='options', to='ticketing.tickettemplatefield', verbose_name='Template Field')),
            ],
            options={
                'verbose_name': 'Template Field Option',
                'verbose_name_plural': 'Template Field Options',
                'ordering': ('template_field', 'option_order', 'id'),
            },
        ),
        migrations.CreateModel(
            name='TicketFieldValue',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('ticket_code', models.CharField(help_text='Cached ticket code', max_length=30, verbose_name='Ticket Code')),
                ('template_field_key', models.CharField(help_text='Cached field key for quick lookup', max_length=100, verbose_name='Template Field Key')),
                ('field_value', models.TextField(blank=True, help_text='Field value (text representation, JSON for complex types)', verbose_name='Field Value')),
                ('field_value_json', models.JSONField(blank=True, help_text='Structured field value (for reference fields, file uploads, etc.)', null=True, verbose_name='Field Value JSON')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('disabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL)),
                ('edited_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL)),
                ('enabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL)),
                ('template_field', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='ticket_values', to='ticketing.tickettemplatefield', verbose_name='Template Field')),
                ('ticket', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='field_values', to='ticketing.ticket', verbose_name='Ticket')),
            ],
            options={
                'verbose_name': 'Ticket Field Value',
                'verbose_name_plural': 'Ticket Field Values',
                'ordering': ('ticket', 'template_field__field_order'),
            },
        ),
        migrations.CreateModel(
            name='TicketComment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('ticket_code', models.CharField(help_text='Cached ticket code', max_length=30, verbose_name='Ticket Code')),
                ('comment_text', models.TextField(verbose_name='Comment Text')),
                ('comment_type', models.CharField(choices=[('comment', 'Comment'), ('internal_note', 'Internal Note'), ('status_change', 'Status Change'), ('assignment', 'Assignment')], default='comment', max_length=20, verbose_name='Comment Type')),
                ('author_username', models.CharField(help_text='Cached author username', max_length=150, verbose_name='Author Username')),
                ('is_internal', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=0, help_text='Internal note flag (visible only to staff)', verbose_name='Is Internal')),
                ('attachments', models.JSONField(blank=True, default=list, help_text='Array of file attachments with metadata', verbose_name='Attachments')),
                ('author', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='ticket_comments', to=settings.AUTH_USER_MODEL, verbose_name='Author')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('disabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL)),
                ('edited_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL)),
                ('enabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL)),
                ('ticket', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comments', to='ticketing.ticket', verbose_name='Ticket')),
            ],
            options={
                'verbose_name': 'Ticket Comment',
                'verbose_name_plural': 'Ticket Comments',
                'ordering': ('ticket', 'created_at'),
            },
        ),
        migrations.CreateModel(
            name='TicketCategoryPermission',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('category_code', models.CharField(help_text='Cached category code', max_length=10, verbose_name='Category Code')),
                ('can_create', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=0, verbose_name='Can Create')),
                ('can_respond', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=0, verbose_name='Can Respond')),
                ('can_close', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=0, verbose_name='Can Close')),
                ('category', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='permissions', to='ticketing.ticketcategory', verbose_name='Category')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('disabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL)),
                ('edited_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL)),
                ('enabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL)),
                ('group', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='ticket_category_permissions', to='auth.group', verbose_name='Group')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='ticket_category_permissions', to=settings.AUTH_USER_MODEL, verbose_name='User')),
            ],
            options={
                'verbose_name': 'Category Permission',
                'verbose_name_plural': 'Category Permissions',
            },
        ),
        migrations.CreateModel(
            name='TicketAttachment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('edited_at', models.DateTimeField(auto_now=True)),
                ('is_enabled', models.PositiveSmallIntegerField(choices=[(0, 'Disabled'), (1, 'Enabled')], default=1)),
                ('enabled_at', models.DateTimeField(blank=True, null=True)),
                ('disabled_at', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('company_code', models.CharField(blank=True, editable=False, max_length=8, validators=[django.core.validators.RegexValidator(message='Only numeric characters are allowed.', regex='^\\d+$')])),
                ('file_name', models.CharField(max_length=255, verbose_name='File Name')),
                ('file_path', models.CharField(help_text='Storage path relative to media root', max_length=500, verbose_name='File Path')),
                ('file_size', models.BigIntegerField(help_text='File size in bytes', verbose_name='File Size')),
                ('mime_type', models.CharField(blank=True, max_length=100, verbose_name='MIME Type')),
                ('uploaded_by_username', models.CharField(help_text='Cached uploader username', max_length=150, verbose_name='Uploaded By Username')),
                ('uploaded_at', models.DateTimeField(default=django.utils.timezone.now, verbose_name='Uploaded At')),
                ('comment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='file_attachments', to='ticketing.ticketcomment', verbose_name='Comment')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('disabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL)),
                ('edited_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL)),
                ('enabled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL)),
                ('ticket', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='file_attachments', to='ticketing.ticket', verbose_name='Ticket')),
                ('uploaded_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='ticket_attachments', to=settings.AUTH_USER_MODEL, verbose_name='Uploaded By')),
            ],
            options={
                'verbose_name': 'Ticket Attachment',
                'verbose_name_plural': 'Ticket Attachments',
                'ordering': ('-uploaded_at',),
            },
        ),
        migrations.AddField(
            model_name='ticket',
            name='category',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tickets', to='ticketing.ticketcategory', verbose_name='Category'),
        ),
        migrations.AddField(
            model_name='ticket',
            name='closed_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='closed_tickets', to=settings.AUTH_USER_MODEL, verbose_name='Closed By'),
        ),
        migrations.AddField(
            model_name='ticket',
            name='company',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='shared.company'),
        ),
        migrations.AddField(
            model_name='ticket',
            name='created_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='ticket',
            name='disabled_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_disabled', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='ticket',
            name='edited_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_edited', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='ticket',
            name='enabled_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_enabled', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='ticket',
            name='locked_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_locked', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='ticket',
            name='priority',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tickets', to='ticketing.ticketpriority', verbose_name='Priority'),
        ),
        migrations.AddField(
            model_name='ticket',
            name='reported_by',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='reported_tickets', to=settings.AUTH_USER_MODEL, verbose_name='Reported By'),
        ),
        migrations.AddField(
            model_name='ticket',
            name='resolved_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resolved_tickets', to=settings.AUTH_USER_MODEL, verbose_name='Resolved By'),
        ),
        migrations.AddField(
            model_name='ticket',
            name='template',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='tickets', to='ticketing.tickettemplate', verbose_name='Template'),
        ),
        migrations.AddField(
            model_name='ticket',
            name='unlocked_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_unlocked', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddIndex(
            model_name='tickettemplatepermission',
            index=models.Index(fields=['template', 'can_create'], name='tkt_tmpl_perm_tmpl_create_idx'),
        ),
        migrations.AddIndex(
            model_name='tickettemplatepermission',
            index=models.Index(fields=['template', 'can_respond'], name='tkt_tmpl_perm_tmpl_resp_idx'),
        ),
        migrations.AddIndex(
            model_name='tickettemplatepermission',
            index=models.Index(fields=['template', 'can_close'], name='tkt_tmpl_perm_tmpl_close_idx'),
        ),
        migrations.AddIndex(
            model_name='tickettemplatepermission',
            index=models.Index(fields=['user', 'can_create'], name='tkt_tmpl_perm_user_create_idx'),
        ),
        migrations.AddIndex(
            model_name='tickettemplatepermission',
            index=models.Index(fields=['user', 'can_respond'], name='tkt_tmpl_perm_user_resp_idx'),
        ),
        migrations.AddIndex(
            model_name='tickettemplatepermission',
            index=models.Index(fields=['user', 'can_close'], name='tkt_tmpl_perm_user_close_idx'),
        ),
        migrations.AddIndex(
            model_name='tickettemplatepermission',
            index=models.Index(fields=['group', 'can_create'], name='tkt_tmpl_perm_grp_create_idx'),
        ),
        migrations.AddIndex(
            model_name='tickettemplatepermission',
            index=models.Index(fields=['group', 'can_respond'], name='tkt_tmpl_perm_grp_resp_idx'),
        ),
        migrations.AddIndex(
            model_name='tickettemplatepermission',
            index=models.Index(fields=['group', 'can_close'], name='tkt_tmpl_perm_grp_close_idx'),
        ),
        migrations.AddConstraint(
            model_name='tickettemplatepermission',
            constraint=models.UniqueConstraint(condition=models.Q(('user__isnull', False)), fields=('template', 'user'), name='ticketing_template_permission_user_unique'),
        ),
        migrations.AddConstraint(
            model_name='tickettemplatepermission',
            constraint=models.UniqueConstraint(condition=models.Q(('group__isnull', False)), fields=('template', 'group'), name='ticketing_template_permission_group_unique'),
        ),
        migrations.AddIndex(
            model_name='tickettemplatefieldoption',
            index=models.Index(fields=['template_field', 'option_order'], name='tkt_tmpl_field_opt_order_idx'),
        ),
        migrations.AddConstraint(
            model_name='tickettemplatefieldoption',
            constraint=models.UniqueConstraint(fields=('template_field', 'option_value'), name='ticketing_template_field_option_field_value_unique'),
        ),
        migrations.AddIndex(
            model_name='tickettemplatefield',
            index=models.Index(fields=['template', 'field_order'], name='tkt_tmpl_field_order_idx'),
        ),
        migrations.AddConstraint(
            model_name='tickettemplatefield',
            constraint=models.UniqueConstraint(fields=('template', 'field_key'), name='ticketing_template_field_template_key_unique'),
        ),
        migrations.AddIndex(
            model_name='tickettemplate',
            index=models.Index(fields=['company', 'category', 'is_enabled', 'sort_order'], name='tkt_tmpl_comp_cat_enabled_idx'),
        ),
        migrations.AddConstraint(
            model_name='tickettemplate',
            constraint=models.UniqueConstraint(fields=('company', 'template_code'), name='ticketing_template_company_code_unique'),
        ),
        migrations.AddIndex(
            model_name='ticketpriority',
            index=models.Index(fields=['company', 'priority_level'], name='tkt_priority_comp_level_idx'),
        ),
        migrations.AddConstraint(
            model_name='ticketpriority',
            constraint=models.UniqueConstraint(fields=('company', 'public_code'), name='ticketing_priority_company_public_code_unique'),
        ),
        migrations.AddConstraint(
            model_name='ticketpriority',
            constraint=models.UniqueConstraint(fields=('company', 'name'), name='ticketing_priority_company_name_unique'),
        ),
        migrations.AddConstraint(
            model_name='ticketpriority',
            constraint=models.UniqueConstraint(fields=('company', 'priority_level'), name='ticketing_priority_company_level_unique'),
        ),
        migrations.AddIndex(
            model_name='ticketfieldvalue',
            index=models.Index(fields=['ticket'], name='tkt_field_val_ticket_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketfieldvalue',
            index=models.Index(fields=['template_field'], name='tkt_field_val_field_idx'),
        ),
        migrations.AddConstraint(
            model_name='ticketfieldvalue',
            constraint=models.UniqueConstraint(fields=('ticket', 'template_field'), name='ticketing_ticket_field_value_ticket_field_unique'),
        ),
        migrations.AddIndex(
            model_name='ticketcomment',
            index=models.Index(fields=['ticket', 'created_at'], name='tkt_comment_ticket_created_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketcategorypermission',
            index=models.Index(fields=['category', 'can_create'], name='tkt_cat_perm_cat_create_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketcategorypermission',
            index=models.Index(fields=['category', 'can_respond'], name='tkt_cat_perm_cat_resp_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketcategorypermission',
            index=models.Index(fields=['category', 'can_close'], name='tkt_cat_perm_cat_close_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketcategorypermission',
            index=models.Index(fields=['user', 'can_create'], name='tkt_cat_perm_user_create_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketcategorypermission',
            index=models.Index(fields=['user', 'can_respond'], name='tkt_cat_perm_user_resp_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketcategorypermission',
            index=models.Index(fields=['user', 'can_close'], name='tkt_cat_perm_user_close_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketcategorypermission',
            index=models.Index(fields=['group', 'can_create'], name='tkt_cat_perm_grp_create_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketcategorypermission',
            index=models.Index(fields=['group', 'can_respond'], name='tkt_cat_perm_grp_resp_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketcategorypermission',
            index=models.Index(fields=['group', 'can_close'], name='tkt_cat_perm_grp_close_idx'),
        ),
        migrations.AddConstraint(
            model_name='ticketcategorypermission',
            constraint=models.UniqueConstraint(condition=models.Q(('user__isnull', False)), fields=('category', 'user'), name='ticketing_category_permission_user_unique'),
        ),
        migrations.AddConstraint(
            model_name='ticketcategorypermission',
            constraint=models.UniqueConstraint(condition=models.Q(('group__isnull', False)), fields=('category', 'group'), name='ticketing_category_permission_group_unique'),
        ),
        migrations.AddIndex(
            model_name='ticketcategory',
            index=models.Index(fields=['company', 'is_enabled', 'sort_order'], name='tkt_cat_comp_enabled_ord_idx'),
        ),
        migrations.AddConstraint(
            model_name='ticketcategory',
            constraint=models.UniqueConstraint(fields=('company', 'public_code'), name='ticketing_category_company_public_code_unique'),
        ),
        migrations.AddConstraint(
            model_name='ticketcategory',
            constraint=models.UniqueConstraint(fields=('company', 'name'), name='ticketing_category_company_name_unique'),
        ),
        migrations.AddIndex(
            model_name='ticketattachment',
            index=models.Index(fields=['ticket'], name='tkt_attachment_ticket_idx'),
        ),
        migrations.AddIndex(
            model_name='ticketattachment',
            index=models.Index(fields=['comment'], name='tkt_attachment_comment_idx'),
        ),
        migrations.AddIndex(
            model_name='ticket',
            index=models.Index(fields=['company', 'status', 'created_at'], name='tkt_comp_status_created_idx'),
        ),
        migrations.AddIndex(
            model_name='ticket',
            index=models.Index(fields=['company', 'assigned_to', 'status'], name='tkt_comp_assign_status_idx'),
        ),
        migrations.AddIndex(
            model_name='ticket',
            index=models.Index(fields=['company', 'category', 'status'], name='tkt_comp_cat_status_idx'),
        ),
        migrations.AddIndex(
            model_name='ticket',
            index=models.Index(fields=['company', 'template', 'status'], name='tkt_comp_tmpl_status_idx'),
        ),
        migrations.AddIndex(
            model_name='ticket',
            index=models.Index(fields=['company', 'priority', 'status'], name='tkt_comp_pri_status_idx'),
        ),
        migrations.AddIndex(
            model_name='ticket',
            index=models.Index(fields=['related_entity_type', 'related_entity_id'], name='tkt_related_entity_idx'),
        ),
        migrations.AddConstraint(
            model_name='ticket',
            constraint=models.UniqueConstraint(fields=('company', 'ticket_code'), name='ticketing_ticket_company_code_unique'),
        ),
    ]
